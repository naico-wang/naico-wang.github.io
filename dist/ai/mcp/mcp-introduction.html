<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MCP 总览 | 智库</title>
    <meta name="description" content="苟利国家生死以，岂因祸福避趋之">
    <meta name="generator" content="VitePress v2.0.0-alpha.16">
    <link rel="preload stylesheet" href="/assets/style.BiE4VZIv.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.YEGqcI-x.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.B0Esan1z.js">
    <link rel="modulepreload" href="/assets/chunks/framework.NCXUupj9.js">
    <link rel="modulepreload" href="/assets/ai_mcp_mcp-introduction.md.ayk_k1Ii.lean.js">
    <link rel="icon" href="/favicon.ico">
    <meta property="og:type" content="website">
    <meta property="og:title" content="智库">
    <meta property="og:description" content="奶一口智库">
    <meta property="og:image" content="https://naico.wang/icons/icon-logo.png">
    <meta property="og:url" content="https://naico.wang">
    <meta name="referrer" content="no-referrer">
    <script>(function(r){"use strict";(function(a){var s=window,e=document,c=r,o="".concat(e.location.protocol==="https:"?"https://":"http://","sdk.51.la/js-sdk-pro.min.js"),t=e.createElement("script"),i=e.getElementsByTagName("script")[0];t.type="text/javascript",t.setAttribute("charset","UTF-8"),t.async=!0,t.src=o,t.id="LA_COLLECT",c.d=t;var n=function(){s.LA.ids.push(c)};s.LA?s.LA.ids&&n():(s.LA=r,s.LA.ids=[],n()),i.parentNode.insertBefore(t,i)})()})({id:"3ItqjsY11mrrfGg3",ck:"3ItqjsY11mrrfGg3",autoTrack:!0,hashMode:!0});</script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d70b1323><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fb4b3d3a></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fb4b3d3a>Skip to content</a><!--]--><!----><header class="VPNav" data-v-d70b1323 data-v-eed9f036><div class="VPNavBar has-sidebar top" data-v-eed9f036 data-v-7f879658><div class="wrapper" data-v-7f879658><div class="container" data-v-7f879658><div class="title" data-v-7f879658><div class="VPNavBarTitle has-sidebar" data-v-7f879658 data-v-e2fe915e><a class="title" href="/" data-v-e2fe915e><!--[--><!--]--><!--[--><!--[--><!--[--><img class="VPImage dark logo" src="/images/logo-dark.svg" alt data-v-978bae9a><!--]--><!--[--><img class="VPImage light logo" src="/images/logo-light.svg" alt data-v-978bae9a><!--]--><!--]--><!--]--><span data-v-e2fe915e>智库</span><!--[--><!--]--></a></div></div><div class="content" data-v-7f879658><div class="content-body" data-v-7f879658><!--[--><!--]--><div class="VPNavBarSearch search" data-v-7f879658 data-v-0a1aad85><!--[--><button type="button" class="VPNavBarSearchButton" aria-label="Search" aria-keyshortcuts="/ control+k meta+k" data-v-0a1aad85 data-v-1c830a8e><span class="vpi-search" aria-hidden="true" data-v-1c830a8e></span><span class="text" data-v-1c830a8e>Search</span><span class="keys" aria-hidden="true" data-v-1c830a8e><kbd class="key-cmd" data-v-1c830a8e>⌘</kbd><kbd class="key-ctrl" data-v-1c830a8e>Ctrl</kbd><kbd data-v-1c830a8e>K</kbd></span></button><!----><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-7f879658 data-v-c90e0688><span id="main-nav-aria-label" class="visually-hidden" data-v-c90e0688> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-c90e0688 data-v-4e284e0d><!--[--><span data-v-4e284e0d>首页</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/ai.html" tabindex="0" data-v-c90e0688 data-v-4e284e0d><!--[--><span data-v-4e284e0d>AI 工程化</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-7f879658 data-v-10edae05><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-10edae05 data-v-771d01e9 data-v-146f5a1e><span class="check" data-v-146f5a1e><span class="icon" data-v-146f5a1e><!--[--><span class="vpi-sun sun" data-v-771d01e9></span><span class="vpi-moon moon" data-v-771d01e9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-7f879658 data-v-4f923422 data-v-1578054f><!--[--><a class="VPSocialLink no-icon" href="https://github.com/naico-wang/naico-wang.github.io" aria-label="github" target="_blank" rel="me noopener" data-v-1578054f data-v-085c7257><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://www.linkedin.com/in/naico-wang-49554891/" aria-label="linkedin" target="_blank" rel="me noopener" data-v-1578054f data-v-085c7257><span class="vpi-social-linkedin"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-7f879658 data-v-6e982ded data-v-b7fe3003><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-b7fe3003><span class="vpi-more-horizontal icon" data-v-b7fe3003></span></button><div class="menu" data-v-b7fe3003><div class="VPMenu" data-v-b7fe3003 data-v-570c90f8><!----><!--[--><!--[--><!----><div class="group" data-v-6e982ded><div class="item appearance" data-v-6e982ded><p class="label" data-v-6e982ded>Appearance</p><div class="appearance-action" data-v-6e982ded><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6e982ded data-v-771d01e9 data-v-146f5a1e><span class="check" data-v-146f5a1e><span class="icon" data-v-146f5a1e><!--[--><span class="vpi-sun sun" data-v-771d01e9></span><span class="vpi-moon moon" data-v-771d01e9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-6e982ded><div class="item social-links" data-v-6e982ded><div class="VPSocialLinks social-links-list" data-v-6e982ded data-v-1578054f><!--[--><a class="VPSocialLink no-icon" href="https://github.com/naico-wang/naico-wang.github.io" aria-label="github" target="_blank" rel="me noopener" data-v-1578054f data-v-085c7257><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://www.linkedin.com/in/naico-wang-49554891/" aria-label="linkedin" target="_blank" rel="me noopener" data-v-1578054f data-v-085c7257><span class="vpi-social-linkedin"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-7f879658 data-v-61d15f3e><span class="container" data-v-61d15f3e><span class="top" data-v-61d15f3e></span><span class="middle" data-v-61d15f3e></span><span class="bottom" data-v-61d15f3e></span></span></button></div></div></div></div><div class="divider" data-v-7f879658><div class="divider-line" data-v-7f879658></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d70b1323 data-v-4d794240><div class="container" data-v-4d794240><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-4d794240><span class="vpi-align-left menu-icon" data-v-4d794240></span><span class="menu-text" data-v-4d794240>菜单</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-4d794240 data-v-1b4724e4><button data-v-1b4724e4>回顶部</button><!----></div></div></div><aside class="VPSidebar" data-v-d70b1323 data-v-286bab1d><div class="curtain" data-v-286bab1d></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-286bab1d><span class="visually-hidden" id="sidebar-aria-label" data-v-286bab1d> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-46e4b36c><section class="VPSidebarItem level-0 collapsible has-active" data-v-46e4b36c data-v-b44a99a2><div class="item" role="button" tabindex="0" data-v-b44a99a2><div class="indicator" data-v-b44a99a2></div><h2 class="text" data-v-b44a99a2>AI 工程化规范</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b44a99a2><span class="vpi-chevron-right caret-icon" data-v-b44a99a2></span></div></div><div class="items" data-v-b44a99a2><!--[--><section class="VPSidebarItem level-1 collapsible has-active" data-v-b44a99a2 data-v-b44a99a2><div class="item" role="button" tabindex="0" data-v-b44a99a2><div class="indicator" data-v-b44a99a2></div><h3 class="text" data-v-b44a99a2>模型上下文协议</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b44a99a2><span class="vpi-chevron-right caret-icon" data-v-b44a99a2></span></div></div><div class="items" data-v-b44a99a2><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b44a99a2 data-v-b44a99a2><div class="item" data-v-b44a99a2><div class="indicator" data-v-b44a99a2></div><a class="VPLink link link" href="/ai/mcp/mcp-introduction.html" data-v-b44a99a2><!--[--><p class="text" data-v-b44a99a2>MCP 总览</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b44a99a2 data-v-b44a99a2><div class="item" data-v-b44a99a2><div class="indicator" data-v-b44a99a2></div><a class="VPLink link link" href="/ai/mcp/mcp-server.html" data-v-b44a99a2><!--[--><p class="text" data-v-b44a99a2>MCP 服务端开发指南</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b44a99a2 data-v-b44a99a2><div class="item" data-v-b44a99a2><div class="indicator" data-v-b44a99a2></div><a class="VPLink link link" href="/ai/mcp/mcp-client.html" data-v-b44a99a2><!--[--><p class="text" data-v-b44a99a2>MCP 客户端开发指南</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b44a99a2 data-v-b44a99a2><div class="item" data-v-b44a99a2><div class="indicator" data-v-b44a99a2></div><a class="VPLink link link" href="/ai/mcp/mcp-security.html" data-v-b44a99a2><!--[--><p class="text" data-v-b44a99a2>MCP 认证与安全</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-b44a99a2 data-v-b44a99a2><div class="item" role="button" tabindex="0" data-v-b44a99a2><div class="indicator" data-v-b44a99a2></div><h3 class="text" data-v-b44a99a2>人工智能体</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b44a99a2><span class="vpi-chevron-right caret-icon" data-v-b44a99a2></span></div></div><div class="items" data-v-b44a99a2><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b44a99a2 data-v-b44a99a2><div class="item" data-v-b44a99a2><div class="indicator" data-v-b44a99a2></div><a class="VPLink link link" href="/ai/agent/agent-overview.html" data-v-b44a99a2><!--[--><p class="text" data-v-b44a99a2>Agent 技术综述</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-b44a99a2 data-v-b44a99a2><div class="item" role="button" tabindex="0" data-v-b44a99a2><div class="indicator" data-v-b44a99a2></div><h3 class="text" data-v-b44a99a2>氛围编程</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b44a99a2><span class="vpi-chevron-right caret-icon" data-v-b44a99a2></span></div></div><div class="items" data-v-b44a99a2><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b44a99a2 data-v-b44a99a2><div class="item" data-v-b44a99a2><div class="indicator" data-v-b44a99a2></div><a class="VPLink link link" href="/ai/vibe-coding/claude-code-guide.html" data-v-b44a99a2><!--[--><p class="text" data-v-b44a99a2>Claude Code 使用指南</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d70b1323 data-v-6843e7e5><div class="VPDoc has-sidebar has-aside" data-v-6843e7e5 data-v-d89afd13><!--[--><!--]--><div class="container" data-v-d89afd13><div class="aside" data-v-d89afd13><div class="aside-curtain" data-v-d89afd13></div><div class="aside-container" data-v-d89afd13><div class="aside-content" data-v-d89afd13><div class="VPDocAside" data-v-d89afd13 data-v-d95d9c8d><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-d95d9c8d data-v-436840d7><div class="content" data-v-436840d7><div class="outline-marker" data-v-436840d7></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-436840d7>页面导航</div><ul class="VPDocOutlineItem root" data-v-436840d7 data-v-54152346><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-d95d9c8d></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-d89afd13><div class="content-container" data-v-d89afd13><!--[--><!--]--><main class="main" data-v-d89afd13><div style="position:relative;" class="vp-doc _ai_mcp_mcp-introduction external-link-icon-enabled" data-v-d89afd13><div><h1 id="mcp-model-context-protocol-总览" tabindex="-1">MCP (Model Context Protocol) 总览 <a class="header-anchor" href="#mcp-model-context-protocol-总览" aria-label="Permalink to “MCP (Model Context Protocol) 总览”">​</a></h1><div class="tip custom-block"><p class="custom-block-title">文档说明</p><p>本文介绍 MCP 的核心概念、架构设计和应用场景，帮助你快速理解这个连接 AI 应用与外部系统的开放标准。</p><p><strong>规范版本</strong>: 2025-11-25<br><strong>官方文档</strong>: <a href="https://modelcontextprotocol.io/specification/2025-11-25" target="_blank" rel="noreferrer">https://modelcontextprotocol.io/specification/2025-11-25</a></p></div><h2 id="什么是-mcp" tabindex="-1">什么是 MCP? <a class="header-anchor" href="#什么是-mcp" aria-label="Permalink to “什么是 MCP?”">​</a></h2><h3 id="核心定义" tabindex="-1">核心定义 <a class="header-anchor" href="#核心定义" aria-label="Permalink to “核心定义”">​</a></h3><p><strong>MCP (Model Context Protocol)</strong> 是一个开源标准协议，用于将 AI 应用与外部数据源、工具和服务安全连接。</p><p>通过 MCP，AI 应用（如 Claude、ChatGPT）可以统一访问:</p><ul><li><strong>数据源</strong>: 本地文件、数据库、云存储</li><li><strong>工具</strong>: 搜索引擎、计算器、API 服务</li><li><strong>工作流</strong>: 提示词模板、自动化流程</li></ul><h3 id="架构全景" tabindex="-1">架构全景 <a class="header-anchor" href="#架构全景" aria-label="Permalink to “架构全景”">​</a></h3><!----><h2 id="为什么选择-mcp" tabindex="-1">为什么选择 MCP? <a class="header-anchor" href="#为什么选择-mcp" aria-label="Permalink to “为什么选择 MCP?”">​</a></h2><h3 id="解决的核心问题" tabindex="-1">解决的核心问题 <a class="header-anchor" href="#解决的核心问题" aria-label="Permalink to “解决的核心问题”">​</a></h3><p>在 MCP 出现之前，AI 应用连接外部系统面临以下挑战：</p><table tabindex="0"><thead><tr><th>传统方案</th><th>存在问题</th><th>MCP 解决方案</th></tr></thead><tbody><tr><td>为每个 AI 应用单独集成</td><td>重复开发，维护成本高</td><td>一次开发，处处可用</td></tr><tr><td>使用私有协议</td><td>供应商锁定，迁移困难</td><td>开放标准，自由切换</td></tr><tr><td>缺乏统一安全机制</td><td>安全风险高，审计困难</td><td>标准化认证和授权</td></tr><tr><td>手动管理上下文</td><td>易出错,效率低</td><td>自动化上下文管理</td></tr></tbody></table><h3 id="典型应用场景" tabindex="-1">典型应用场景 <a class="header-anchor" href="#典型应用场景" aria-label="Permalink to “典型应用场景”">​</a></h3><p><strong>1. 企业知识库接入</strong></p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span>场景: 让 AI 助手访问公司内部文档、Wiki、数据库</span></span>
<span class="line"><span>方案: 部署 MCP Server 连接企业数据源</span></span>
<span class="line"><span>效果: 员工可以用自然语言查询公司知识</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>2. 开发工具链集成</strong></p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span>场景: AI 辅助编程时需要访问 Git、CI/CD、监控系统</span></span>
<span class="line"><span>方案: 使用现成的 MCP Server (Git, Sentry, etc.)</span></span>
<span class="line"><span>效果: AI 可以读取代码、查看错误日志、触发构建</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>3. 自动化工作流</strong></p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span>场景: 通过 AI 自动处理重复性任务</span></span>
<span class="line"><span>方案: 开发自定义 MCP Server 暴露业务工具</span></span>
<span class="line"><span>效果: 用对话方式完成复杂操作(如生成报告、发送通知)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="生态系统对比" tabindex="-1">生态系统对比 <a class="header-anchor" href="#生态系统对比" aria-label="Permalink to “生态系统对比”">​</a></h3><p>MCP 与其他 AI 开发框架的关系：</p><!----><p><strong>MCP 的定位</strong>：专注于<strong>连接层标准化</strong>，而非全栈解决方案。可与 LangChain/Dify 等框架配合使用。</p><h2 id="mcp-架构详解" tabindex="-1">MCP 架构详解 <a class="header-anchor" href="#mcp-架构详解" aria-label="Permalink to “MCP 架构详解”">​</a></h2><h3 id="核心组件" tabindex="-1">核心组件 <a class="header-anchor" href="#核心组件" aria-label="Permalink to “核心组件”">​</a></h3><p>MCP 采用<strong>客户端-服务器</strong>架构，涉及三个核心角色：</p><!----><h4 id="_1-mcp-host-宿主应用" tabindex="-1">1. MCP Host (宿主应用) <a class="header-anchor" href="#_1-mcp-host-宿主应用" aria-label="Permalink to “1. MCP Host (宿主应用)”">​</a></h4><table tabindex="0"><thead><tr><th>职责</th><th>典型实现</th></tr></thead><tbody><tr><td>协调多个 MCP Client</td><td>Claude Desktop / Codex 等桌面应用</td></tr><tr><td>提供用户交互界面</td><td>Claude Code / OpenCode 等命令行工具</td></tr><tr><td>管理 AI 模型调用</td><td>自定义聊天应用</td></tr></tbody></table><h4 id="_2-mcp-client-客户端" tabindex="-1">2. MCP Client (客户端) <a class="header-anchor" href="#_2-mcp-client-客户端" aria-label="Permalink to “2. MCP Client (客户端)”">​</a></h4><table tabindex="0"><thead><tr><th>职责</th><th>重要特性</th></tr></thead><tbody><tr><td>维护与单个 Server 的连接</td><td>一个 Client 只连接一个 Server</td></tr><tr><td>获取上下文数据供 Host 使用</td><td>一个 Host 可管理多个 Client</td></tr><tr><td>处理协议层通信</td><td>支持动态连接/断开</td></tr></tbody></table><h4 id="_3-mcp-server-服务器" tabindex="-1">3. MCP Server (服务器) <a class="header-anchor" href="#_3-mcp-server-服务器" aria-label="Permalink to “3. MCP Server (服务器)”">​</a></h4><p><strong>职责</strong>:</p><ul><li>提供工具、资源、提示词</li><li>处理 Client 请求</li><li>发送实时更新通知</li></ul><p><strong>部署模式</strong>:</p><table tabindex="0"><thead><tr><th>类型</th><th>传输方式</th><th>部署位置</th><th>典型场景</th></tr></thead><tbody><tr><td>本地 Server</td><td><strong>STDIO</strong></td><td>同一台机器</td><td>文件系统访问、本地数据库</td></tr><tr><td>远程 Server</td><td><strong>HTTP</strong></td><td>云端/其他主机</td><td>SaaS API、企业内网服务</td></tr></tbody></table><h2 id="协议分层设计" tabindex="-1">协议分层设计 <a class="header-anchor" href="#协议分层设计" aria-label="Permalink to “协议分层设计”">​</a></h2><p>MCP 采用<strong>两层架构</strong>,清晰分离通信机制与业务逻辑:</p><!----><h3 id="数据层-data-layer" tabindex="-1">数据层 (Data Layer) <a class="header-anchor" href="#数据层-data-layer" aria-label="Permalink to “数据层 (Data Layer)”">​</a></h3><p>基于 <strong><a href="https://www.jsonrpc.org/" target="_blank" rel="noreferrer">JSON-RPC 2.0</a></strong> 实现，定义消息格式和语义。</p><h4 id="核心功能模块" tabindex="-1">核心功能模块 <a class="header-anchor" href="#核心功能模块" aria-label="Permalink to “核心功能模块”">​</a></h4><p><strong>1. 生命周期管理</strong></p><ul><li>连接初始化和能力协商</li><li>心跳保活</li><li>优雅关闭</li></ul><p><strong>2. 服务器能力</strong></p><ul><li><strong>Tools</strong>: 可执行函数(如文件操作、API 调用)</li><li><strong>Resources</strong>: 上下文数据(如文档内容、数据库记录)</li><li><strong>Prompts</strong>: 交互模板(如预设提示词)</li></ul><p><strong>3. 客户端能力</strong></p><ul><li><strong>Sampling</strong>: 请求 Host 的 LLM 进行推理</li><li><strong>Elicitation</strong>: 向用户请求额外信息</li><li><strong>Logging</strong>: 发送调试日志</li></ul><p><strong>4. 实用功能</strong></p><ul><li><strong>Notifications</strong>: 实时更新通知</li><li><strong>Tasks</strong>: 长时间运行任务的进度跟踪(实验性)</li></ul><h4 id="json-rpc-消息示例" tabindex="-1">JSON-RPC 消息示例 <a class="header-anchor" href="#json-rpc-消息示例" aria-label="Permalink to “JSON-RPC 消息示例”">​</a></h4><p><strong>请求消息:</strong></p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;jsonrpc&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;2.0&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;id&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#F8F8F8;"> 1</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;method&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;tools/list&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;params&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {}</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>响应消息:</strong></p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;jsonrpc&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;2.0&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;id&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#F8F8F8;"> 1</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;result&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">    &quot;tools&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">      {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">        &quot;name&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;search_files&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">        &quot;description&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;在指定目录搜索文件&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">        &quot;inputSchema&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">          &quot;type&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;object&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">          &quot;properties&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">            &quot;query&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> { </span><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">&quot;type&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;string&quot;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> }</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">            &quot;path&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> { </span><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">&quot;type&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;string&quot;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">          }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>通知消息(无需响应):</strong></p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;jsonrpc&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;2.0&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;method&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;notifications/tools/list_changed&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;params&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {}</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="传输层-transport-layer" tabindex="-1">传输层 (Transport Layer) <a class="header-anchor" href="#传输层-transport-layer" aria-label="Permalink to “传输层 (Transport Layer)”">​</a></h3><p>负责底层通信通道和安全认证。</p><h4 id="stdio-传输" tabindex="-1">STDIO 传输 <a class="header-anchor" href="#stdio-传输" aria-label="Permalink to “STDIO 传输”">​</a></h4><p><strong>适用场景</strong>: 本地进程通信</p><p><strong>特点</strong>:</p><ul><li>零网络开销,性能最优</li><li>无需处理防火墙/代理</li><li>仅限同一台机器</li></ul><p><strong>启动方式</strong>:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#6B737C;"># Host 启动 Server 进程并通过 stdin/stdout 通信</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node</span><span style="--shiki-light:#2B5581;--shiki-dark:#9DB1C5;"> /path/to/mcp-server.js</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="http-传输" tabindex="-1">HTTP 传输 <a class="header-anchor" href="#http-传输" aria-label="Permalink to “HTTP 传输”">​</a></h4><p><strong>适用场景</strong>: 远程服务器通信</p><p><strong>特点</strong>:</p><ul><li>支持跨网络访问</li><li>标准 HTTP 认证(Bearer Token, API Key, OAuth)</li><li>服务器发送事件(SSE)支持流式响应</li><li>需要处理网络安全和延迟</li></ul><p><strong>请求示例</strong>:</p><div class="language-http line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">POST</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> /mcp </span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">HTTP</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">/</span><span style="--shiki-light:#1976D2;--shiki-dark:#F8F8F8;">1.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;">Host</span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#2B5581;--shiki-dark:#9DB1C5;"> api.example.com</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;">Authorization</span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#2B5581;--shiki-dark:#9DB1C5;"> Bearer &lt;token&gt;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;">Content-Type</span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#2B5581;--shiki-dark:#9DB1C5;"> application/json</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;jsonrpc&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;2.0&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;id&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#F8F8F8;"> 1</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;method&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;tools/call&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;params&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">    &quot;name&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;search&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">    &quot;arguments&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> { </span><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">&quot;query&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;MCP tutorial&quot;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="数据层协议详解" tabindex="-1">数据层协议详解 <a class="header-anchor" href="#数据层协议详解" aria-label="Permalink to “数据层协议详解”">​</a></h2><h3 id="基本元素-primitives" tabindex="-1">基本元素 (Primitives) <a class="header-anchor" href="#基本元素-primitives" aria-label="Permalink to “基本元素 (Primitives)”">​</a></h3><p>MCP 定义了三类核心基本元素，决定了 Server 可以提供哪些能力。</p><h4 id="server-端基本元素" tabindex="-1">Server 端基本元素 <a class="header-anchor" href="#server-端基本元素" aria-label="Permalink to “Server 端基本元素”">​</a></h4><p><strong>1. Tools (工具)</strong></p><p>可被 AI 调用的函数,用于执行操作。</p><p><strong>发现与调用流程</strong>:</p><!----><p><strong>定义示例</strong>:</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">{</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  name</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;read_file&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  description</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;读取文件内容&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  inputSchema</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    type</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;object&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    properties</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">      path</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">        type</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;string&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">        description</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;文件路径&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    }</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    required</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> [</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;">&quot;path&quot;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">]</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>2. Resources (资源)</strong></p><p>提供上下文数据的只读信息源。</p><p><strong>URI 设计模式</strong>:</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span>file:///home/user/documents/report.pdf</span></span>
<span class="line"><span>db://localhost/products/table/users</span></span>
<span class="line"><span>api://github.com/repos/owner/repo/issues/123</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>访问示例</strong>:</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;method&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;resources/read&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;params&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">    &quot;uri&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;file:///home/user/config.json&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>3. Prompts (提示词)</strong></p><p>预定义的交互模板,简化常见任务。</p><p><strong>模板示例</strong>:</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;name&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;code_review&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;description&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;代码审查助手&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;arguments&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;name&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;language&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;description&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;编程语言&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;required&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    }</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;name&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;focus&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;description&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;关注点(安全/性能/可读性)&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;required&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="client-端基本元素" tabindex="-1">Client 端基本元素 <a class="header-anchor" href="#client-端基本元素" aria-label="Permalink to “Client 端基本元素”">​</a></h4><p><strong>1. Sampling (采样)</strong></p><p>Server 请求 Host 的 LLM 进行推理。</p><p><strong>使用场景</strong>:</p><ul><li>数据分析和总结</li><li>内容生成</li><li>决策辅助</li></ul><p><strong>请求示例</strong>:</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;method&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;sampling/createMessage&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;params&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">    &quot;messages&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">      {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">        &quot;role&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;user&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">        &quot;content&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;分析这份销售数据并给出建议: [数据]&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    ]</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">    &quot;maxTokens&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#F8F8F8;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>2. Elicitation (信息征询)</strong></p><p>向用户请求额外输入。</p><p><strong>使用场景</strong>:</p><ul><li>确认敏感操作</li><li>收集缺失参数</li><li>多步骤交互</li></ul><p><strong>请求示例</strong>:</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;method&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;elicitation/request&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;params&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">    &quot;message&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;请选择部署环境&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">    &quot;schema&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;type&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;object&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;properties&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">        &quot;environment&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">          &quot;type&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;string&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">          &quot;enum&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> [</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;">&quot;dev&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;staging&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;production&quot;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">]</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>3. Logging (日志)</strong></p><p>向 Host 发送调试信息。</p><p><strong>日志级别</strong>:</p><div class="language-typescript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">enum</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> LogLevel</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  DEBUG </span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;debug&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  INFO </span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;info&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  WARNING </span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;warning&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  ERROR </span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;error&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><hr><h3 id="生命周期管理" tabindex="-1">生命周期管理 <a class="header-anchor" href="#生命周期管理" aria-label="Permalink to “生命周期管理”">​</a></h3><h4 id="初始化序列" tabindex="-1">初始化序列 <a class="header-anchor" href="#初始化序列" aria-label="Permalink to “初始化序列”">​</a></h4><!----><h4 id="能力协商示例" tabindex="-1">能力协商示例 <a class="header-anchor" href="#能力协商示例" aria-label="Permalink to “能力协商示例”">​</a></h4><p><strong>Client 声明的能力</strong>:</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;capabilities&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">    &quot;sampling&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {}</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">    &quot;elicitation&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {}</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">    &quot;roots&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;listChanged&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>Server 声明的能力</strong>:</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;capabilities&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">    &quot;tools&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;listChanged&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    }</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">    &quot;resources&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;subscribe&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;listChanged&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    }</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">    &quot;prompts&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;listChanged&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="通知机制" tabindex="-1">通知机制 <a class="header-anchor" href="#通知机制" aria-label="Permalink to “通知机制”">​</a></h3><p>支持 Server 向 Client 主动推送更新。</p><h4 id="通知类型" tabindex="-1">通知类型 <a class="header-anchor" href="#通知类型" aria-label="Permalink to “通知类型”">​</a></h4><table tabindex="0"><thead><tr><th>通知方法</th><th>触发时机</th><th>用途</th></tr></thead><tbody><tr><td><code>notifications/tools/list_changed</code></td><td>工具清单变化</td><td>提示 Client 重新获取工具列表</td></tr><tr><td><code>notifications/resources/list_changed</code></td><td>资源清单变化</td><td>提示 Client 刷新资源</td></tr><tr><td><code>notifications/resources/updated</code></td><td>资源内容更新</td><td>订阅的资源有新数据</td></tr><tr><td><code>notifications/prompts/list_changed</code></td><td>提示词变化</td><td>提示 Client 更新模板</td></tr></tbody></table><h4 id="资源订阅示例" tabindex="-1">资源订阅示例 <a class="header-anchor" href="#资源订阅示例" aria-label="Permalink to “资源订阅示例”">​</a></h4><p><strong>订阅流程</strong>:</p><!----><h2 id="协议范围与边界" tabindex="-1">协议范围与边界 <a class="header-anchor" href="#协议范围与边界" aria-label="Permalink to “协议范围与边界”">​</a></h2><h3 id="mcp-负责的部分" tabindex="-1"><u>MCP 负责</u>的部分 <a class="header-anchor" href="#mcp-负责的部分" aria-label="Permalink to “MCP 负责的部分”">​</a></h3><p><strong>定义标准化通信协议</strong></p><ul><li>JSON-RPC 消息格式</li><li>能力发现机制</li><li>生命周期管理</li></ul><p><strong>提供 SDK 和工具</strong></p><ul><li>TypeScript/Python/Java SDK</li><li>MCP Inspector 调试工具</li><li>参考服务器实现</li></ul><p><strong>建立生态系统</strong></p><ul><li>官方服务器目录</li><li>社区贡献指南</li><li>最佳实践文档</li></ul><h3 id="mcp-不负责的部分" tabindex="-1"><u>MCP 不负责</u>的部分 <a class="header-anchor" href="#mcp-不负责的部分" aria-label="Permalink to “MCP 不负责的部分”">​</a></h3><p><strong>LLM 选择和调用</strong></p><ul><li>Host 自行决定使用哪个 AI 模型</li><li>如何利用上下文生成回复</li></ul><p><strong>用户界面设计</strong></p><ul><li>Host 负责 UI/UX</li><li>交互流程由应用定义</li></ul><p><strong>业务逻辑实现</strong></p><ul><li>Server 的具体功能由开发者实现</li><li>MCP 只定义通信标准</li></ul><h2 id="快速开始" tabindex="-1">快速开始 <a class="header-anchor" href="#快速开始" aria-label="Permalink to “快速开始”">​</a></h2><h3 id="使用现有-server" tabindex="-1">使用现有 Server <a class="header-anchor" href="#使用现有-server" aria-label="Permalink to “使用现有 Server”">​</a></h3><p><strong>1. 安装 Claude Desktop</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#6B737C;"># macOS</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#2B5581;--shiki-dark:#9DB1C5;"> install</span><span style="--shiki-light:#2B5581;--shiki-dark:#9DB1C5;"> --cask</span><span style="--shiki-light:#2B5581;--shiki-dark:#9DB1C5;"> claude</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#6B737C;"># 或从官网下载</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#6B737C;"># https://claude.ai/download</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>2. 配置 MCP Server</strong></p><p>编辑配置文件 <code>~/Library/Application Support/Claude/claude_desktop_config.json</code>:</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">{</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">  &quot;mcpServers&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">    &quot;filesystem&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;command&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;npx&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;args&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> [</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;">&quot;-y&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;@modelcontextprotocol/server-filesystem&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;/Users/yourname/Documents&quot;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">]</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    }</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">    &quot;sqlite&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;command&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;npx&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F8F8F8;">      &quot;args&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> [</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;">&quot;-y&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;@modelcontextprotocol/server-sqlite&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;/path/to/database.db&quot;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">]</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>3. 重启 Claude Desktop</strong></p><p>现在可以在对话中使用文件系统和数据库工具了!</p><h2 id="最佳实践" tabindex="-1">最佳实践 <a class="header-anchor" href="#最佳实践" aria-label="Permalink to “最佳实践”">​</a></h2><h3 id="server-设计原则" tabindex="-1">Server 设计原则 <a class="header-anchor" href="#server-设计原则" aria-label="Permalink to “Server 设计原则”">​</a></h3><p><strong>1. 单一职责</strong></p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span>✅ 好: SQLite Server 只处理数据库操作</span></span>
<span class="line"><span>❌ 差: 一个 Server 同时处理文件、数据库、API</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>2. 幂等性</strong></p><div class="language-typescript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#6B737C;">// 工具调用应该是幂等的</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> readFile</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">(path</span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">) {</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#6B737C;">  // ✅ 多次调用返回相同结果</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#1976D2;--shiki-dark:#79B8FF;"> fs</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.readFileSync</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">(path</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &#39;utf-8&#39;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">);</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> deleteFile</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">(path</span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">) {</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#6B737C;">  // ⚠️ 需要处理已删除的情况</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> (</span><span style="--shiki-light:#1976D2;--shiki-dark:#79B8FF;">fs</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.existsSync</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">(path)) {</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#79B8FF;">    fs</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.unlinkSync</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">(path);</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>3. 错误处理</strong></p><div class="language-typescript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#6B737C;">// 返回有意义的错误信息</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">{</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;">  &quot;error&quot;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">: {</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;">    &quot;code&quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#1976D2;--shiki-dark:#F8F8F8;">32602</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;">    &quot;message&quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;文件不存在: /path/to/file.txt&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;">    &quot;data&quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;">      &quot;path&quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;/path/to/file.txt&quot;</span><span style="--shiki-light:#212121;--shiki-dark:#BBBBBB;">,</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;">      &quot;suggestion&quot;</span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;"> &quot;请检查文件路径是否正确&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="client-集成建议" tabindex="-1">Client 集成建议 <a class="header-anchor" href="#client-集成建议" aria-label="Permalink to “Client 集成建议”">​</a></h3><p><strong>1. 优雅降级</strong></p><div class="language-typescript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#6B737C;">// Server 不可用时不应阻塞整个应用</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">try</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#1976D2;--shiki-dark:#79B8FF;"> client</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.connect</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">(serverPath);</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">} </span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> (error) {</span></span>
<span class="line"><span style="--shiki-light:#1976D2;--shiki-dark:#79B8FF;">  console</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.warn</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;">&quot;MCP Server 连接失败,部分功能不可用&quot;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">);</span></span>
<span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#6B737C;">  // 继续运行,禁用相关功能</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>2. 资源管理</strong></p><div class="language-typescript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes min-light min-dark" style="--shiki-light:#24292eff;--shiki-dark:#b392f0;--shiki-light-bg:#ffffff;--shiki-dark-bg:#1f1f1f;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-dark:#6B737C;">// 确保连接正确关闭</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">try</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#1976D2;--shiki-dark:#79B8FF;"> client</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.callTool</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">(</span><span style="--shiki-light:#22863A;--shiki-dark:#FFAB70;">&quot;expensive_operation&quot;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">);</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">} </span><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">finally</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#1976D2;--shiki-dark:#79B8FF;"> client</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.close</span><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">();</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#B392F0;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="下一步" tabindex="-1">下一步 <a class="header-anchor" href="#下一步" aria-label="Permalink to “下一步”">​</a></h2><p>根据你的需求选择相应路径:</p><ul><li><p><strong>开发 MCP Server</strong> → 阅读 <a href="./mcp-server.html">MCP Server 开发指南</a></p></li><li><p><strong>集成 MCP 到应用</strong> → 阅读 <a href="./mcp-client.html">MCP Client 开发指南</a></p></li><li><p><strong>安全性问题</strong> → 阅读 <a href="./mcp-security.html">MCP 认证与安全</a></p></li></ul><h2 id="常见问题" tabindex="-1">常见问题 <a class="header-anchor" href="#常见问题" aria-label="Permalink to “常见问题”">​</a></h2><details><summary><b>MCP 与 LangChain 有什么区别?</b></summary><ul><li><strong>MCP</strong>: 专注于连接层标准化,轻量级协议</li><li><strong>LangChain</strong>: 全栈 AI 应用开发框架,功能更丰富</li></ul><p>两者可以配合使用,LangChain 可以作为 MCP Host 或 Server。</p></details><details><summary><b>MCP Server 必须用 TypeScript 开发吗?</b></summary><p>不是。官方提供 TypeScript、Python、Java SDK,社区也有其他语言实现。只要遵循 JSON-RPC 2.0 协议,任何语言都可以。</p></details><details><summary><b>远程 Server 如何保证安全?</b></summary><p>推荐使用:</p><ol><li>HTTPS 加密传输</li><li>OAuth 2.0 认证</li><li>API Key 轮换机制</li><li>请求速率限制</li></ol><p>详见<a href="./mcp-security.html">安全最佳实践文档</a>。</p></details><details><summary><b>一个 Host 可以连接多少个 Server?</b></summary><p>理论上无限制,但建议:</p><ul><li>少于 10 个以保证性能</li><li>按需加载,避免一次启动所有 Server</li><li>监控资源使用情况</li></ul></details><h2 id="生态系统资源" tabindex="-1">生态系统资源 <a class="header-anchor" href="#生态系统资源" aria-label="Permalink to “生态系统资源”">​</a></h2><h3 id="开发自定义-server" tabindex="-1">开发自定义 Server <a class="header-anchor" href="#开发自定义-server" aria-label="Permalink to “开发自定义 Server”">​</a></h3><ul><li><a href="./mcp-server.html">开发 MCP Server</a></li><li><a href="./mcp-client.html">开发 MCP Client</a></li><li><a href="./mcp-security.html">认证与安全</a></li></ul><h3 id="官方资源" tabindex="-1">官方资源 <a class="header-anchor" href="#官方资源" aria-label="Permalink to “官方资源”">​</a></h3><ul><li><a href="https://spec.modelcontextprotocol.io/" target="_blank" rel="noreferrer">MCP 规范文档</a></li><li><a href="https://github.com/modelcontextprotocol/typescript-sdk" target="_blank" rel="noreferrer">TypeScript SDK</a></li><li><a href="https://github.com/modelcontextprotocol/python-sdk" target="_blank" rel="noreferrer">Python SDK</a></li><li><a href="https://github.com/modelcontextprotocol/java-sdk" target="_blank" rel="noreferrer">Java SDK</a></li><li><a href="https://github.com/modelcontextprotocol/inspector" target="_blank" rel="noreferrer">MCP Inspector</a></li></ul><h3 id="参考实现" tabindex="-1">参考实现 <a class="header-anchor" href="#参考实现" aria-label="Permalink to “参考实现”">​</a></h3><ul><li><a href="https://github.com/modelcontextprotocol/servers/tree/main/src/filesystem" target="_blank" rel="noreferrer">文件系统 Server</a></li><li><a href="https://github.com/modelcontextprotocol/servers/tree/main/src/sqlite" target="_blank" rel="noreferrer">SQLite Server</a></li><li><a href="https://github.com/modelcontextprotocol/servers/tree/main/src/git" target="_blank" rel="noreferrer">Git Server</a></li><li><a href="https://github.com/modelcontextprotocol/servers" target="_blank" rel="noreferrer">更多官方 Servers</a></li></ul><h3 id="社区支持" tabindex="-1">社区支持 <a class="header-anchor" href="#社区支持" aria-label="Permalink to “社区支持”">​</a></h3><ul><li><a href="https://github.com/modelcontextprotocol/specification/discussions" target="_blank" rel="noreferrer">GitHub Discussions</a></li><li><a href="https://discord.gg/modelcontextprotocol" target="_blank" rel="noreferrer">Discord 社区</a></li><li><a href="https://github.com/modelcontextprotocol/quickstart-resources" target="_blank" rel="noreferrer">示例项目</a></li></ul><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to “总结”">​</a></h2><p>MCP 通过标准化协议解决了 AI 应用与外部系统集成的复杂性:</p><p><strong>开放标准</strong> - 避免供应商锁定<br><strong>清晰分层</strong> - 传输层与业务逻辑分离<br><strong>丰富生态</strong> - 官方和社区提供大量现成 Server<br><strong>安全可靠</strong> - 支持标准认证和授权机制</p></div></div></main><footer class="VPDocFooter" data-v-d89afd13 data-v-4a2af9f5><!--[--><!--]--><div class="edit-info" data-v-4a2af9f5><!----><div class="last-updated" data-v-4a2af9f5><p class="VPLastUpdated" data-v-4a2af9f5 data-v-0a1a09f1>最后更新于: <time datetime="2026-02-16T12:42:59.000Z" data-v-0a1a09f1></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4a2af9f5><span class="visually-hidden" id="doc-footer-aria-label" data-v-4a2af9f5>Pager</span><div class="pager" data-v-4a2af9f5><!----></div><div class="pager" data-v-4a2af9f5><a class="VPLink link pager-link next" href="/ai/mcp/mcp-server.html" data-v-4a2af9f5><!--[--><span class="desc" data-v-4a2af9f5>下一篇</span><span class="title" data-v-4a2af9f5>MCP 服务端开发指南</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-d70b1323 data-v-937f3382><div class="container" data-v-937f3382><p class="message" data-v-937f3382>Powered by <a href="https://vitepress.dev/">VitePress</a>. Statics by <a target="_blank" title="51la网站统计" href="https://v6.51.la/land/3ItqjsY11mrrfGg3">51la统计</a></p><p class="copyright" data-v-937f3382>Copyright © 2024 <a href="https://github.com/naico-wang">Naico Wang</a></p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"ai_agent_agent-overview.md\":\"ljd5wbxE\",\"ai_index.md\":\"BQ4i9CCb\",\"ai_mcp_mcp-client.md\":\"C2_3sXsE\",\"ai_mcp_mcp-introduction.md\":\"ayk_k1Ii\",\"ai_mcp_mcp-security.md\":\"B0L4iwfE\",\"ai_mcp_mcp-server.md\":\"OXsBFHtw\",\"ai_vibe-coding_claude-code-guide.md\":\"BeqRxoa0\",\"index.md\":\"D8t8BaNP\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"智库\",\"description\":\"苟利国家生死以，岂因祸福避趋之\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":{\"light\":\"/images/logo-light.svg\",\"dark\":\"/images/logo-dark.svg\"},\"search\":{\"provider\":\"local\"},\"nav\":[{\"text\":\"首页\",\"link\":\"/\"},{\"text\":\"AI 工程化\",\"link\":\"/ai\"}],\"sidebar\":[{\"text\":\"AI 工程化规范\",\"position\":3,\"items\":[{\"text\":\"模型上下文协议\",\"position\":1,\"items\":[{\"text\":\"MCP 总览\",\"position\":1,\"link\":\"/ai/mcp/mcp-introduction\"},{\"text\":\"MCP 服务端开发指南\",\"position\":2,\"link\":\"/ai/mcp/mcp-server\"},{\"text\":\"MCP 客户端开发指南\",\"position\":3,\"link\":\"/ai/mcp/mcp-client\"},{\"text\":\"MCP 认证与安全\",\"position\":6,\"link\":\"/ai/mcp/mcp-security\"}],\"collapsed\":false},{\"text\":\"人工智能体\",\"position\":2,\"items\":[{\"text\":\"Agent 技术综述\",\"position\":1,\"link\":\"/ai/agent/agent-overview\"}],\"collapsed\":false},{\"text\":\"氛围编程\",\"position\":88,\"items\":[{\"text\":\"Claude Code 使用指南\",\"position\":999,\"link\":\"/ai/vibe-coding/claude-code-guide\"}],\"collapsed\":false}],\"collapsed\":false}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/naico-wang/naico-wang.github.io\"},{\"icon\":\"linkedin\",\"link\":\"https://www.linkedin.com/in/naico-wang-49554891/\"}],\"outline\":{\"label\":\"页面导航\"},\"lastUpdated\":{\"text\":\"最后更新于\",\"formatOptions\":{\"dateStyle\":\"short\",\"timeStyle\":\"short\",\"forceLocale\":true}},\"docFooter\":{\"prev\":\"上一篇\",\"next\":\"下一篇\"},\"footer\":{\"message\":\"Powered by <a href=\\\"https://vitepress.dev/\\\">VitePress</a>. Statics by <a target=\\\"_blank\\\" title=\\\"51la网站统计\\\" href=\\\"https://v6.51.la/land/3ItqjsY11mrrfGg3\\\">51la统计</a>\",\"copyright\":\"Copyright © 2024 <a href=\\\"https://github.com/naico-wang\\\">Naico Wang</a>\"},\"returnToTopLabel\":\"回顶部\",\"sidebarMenuLabel\":\"菜单\",\"externalLinkIcon\":true},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>